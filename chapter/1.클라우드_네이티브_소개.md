# 클라우드 네이티브 소개

## 클라우드 네이티브란 무엇인가?
클라우드 네이티브 애플리케이션은 클라우드에서 실행되면서 변화에 탄력적으로 대응하고, 고도로 분산되어 있는 시스템이다.
 시스템은 여러 개의 서비스로 구성되며 이 서비스들은 네트워크를 통해 서로 통신한다. 또한 이 시스템은 끊이없이 변하는 동적 환경에 배포한다.

**그렇다면 어떻게 하는 것이 클라우드 네이티브일까?**

클라우드 네이티브 애플리케이션은 클라우드를 위해 특별히 설계되어야 하고, 클라우드 환경과 클라우드 컴퓨팅 모델의 장점을 활용할 수 있는 특성이 있어야 한다.

애플리케이션이 클라우드를 위해 특별히 설계된다는 것은 무엇을 의미할까? </br>
`클라우드의 세가지 P`를 준수하는 것이다.

1. 플랫폼(Platform) : 클라우드 네이티브 애플리케이션은 클라우드 같은 동적 분산 환경을 기반으로 하는 플랫폼에서 실행된다.
2. 속성(Properties) : 클라우드 네이티브 애플리케이션은 확장 가능하고 느슨하게 결합되며 복원력이 뛰어나고 관찰 가능하도록 설계된다.
3. 실행(Practice) : 클라우드 네이티브 애플리케이션은 빈번하고 예측 가능한 방식으로 시스템을 변경한다. (자동화, 지속적 전달, 데브옵스 등)


### 클라우드 배포 모델
1. 사설 클라우드 : 한 단체나 조직에서만 사용하도록 제공하는 클라우드 인프라이다. 예를 들어, 은행 같은 곳은 자체 클라우드 인프라를 구축할 가능성이 높다.
2. 공공 클라우드 : 일반 사용자들에게 공공으로 제공되는 클라우드 인프라이다. 예를 들어 AWS, Azure, GCP 등이 있다.
3. 하이브리드 클라우드 : 앞의 두 가지 유형에 해당하는 클라우드 인프라 구성 몇개를 하나로 묶어 마치 하나의 단일 환경인 것처럼 서비스를 제공한다.


### 클라우드 컴퓨팅 모델
1. IaaS(Infrastructure as a Service) : 가상 서버, 스토리지, 네트워크 등의 인프라를 제공한다.
2. CaaS(Container as a Service) : 컨테이너 관리 플랫폼을 제공한다.
3. PaaS(Platform as a Service) : 애플리케이션을 개발하고 실행하기 위한 플랫폼을 제공한다.
4. FaaS(Function as a Service) : 함수를 실행하기 위한 플랫폼(이를 실행할 인프라 포함)을 제공한다.
5. SaaS(Software as a Service) : 소프트웨어(이를 실행할 전체 인프라 포함)를 제공한다.

### 클라우드 네이티브 애플리케이션의 특성
CNCF(Cloud Native Computing Foundation)에서는 클라우드 네이티브 애플리케이션이 가져야 할 다섯 가지 주요 속성을 정의한다.
클라우드는 '어디'(where)에 관한 것이고, 클라우드 네이티브는 '어떻게'(how)에 관한 것이다. 아래 내용은 가볍게 읽어보자.

1. 확장성 <br>
   이것이 의미하는 바는 추가 리소스를 제공해 증가하는 워크로드를 지원한다는 것이다. 이러한 추가 리소스의 특성에 따라 수직적 확장과 수평적 확장으로 나눌 수 있다.
   1. 수직적 확장 : 서버 자체의 스펙을 향상시키는 방법으로 CPU, 메모리, 디스크 등의 리소스를 추가하는 방법이다.
   2. 수평적 확장 : 서버의 수를 늘리는 방법으로 여러 대의 서버를 늘려서 확장하기에, 애플리케이션이 확장 가능하도록 만들어야 한다.
2. 느슨한 결합 <br>
   각 컴포넌트들이 가능한 한 다른 컴포넌트에 대한 지식을 거의 가지고 있지 않은 시스템이 본질적으로 가지고 있는 속성이 **느슨한 결합**이다.
3. 복원력 <br>
   정상 작동에 대한 오류 및 문제에 직면하여 허용 가능한 수준의 서비스를 제공하고 유지할 수 있도록 하는 하드웨어-소프트웨어 네트워크의 기능이다. (결함이나 환경 변화가 있는 경우에도 서비스를 제공한다는 뜻)
   - 결함 : 결함은 소프트웨어 또는 인프라에서 잘못된 내부 상태를 생성하는 고장이다. 예를 들면 널이 아닌 값을 반환해야 하는 메서드가 널 값을 반환하는 경우이다.
   - 오류 : 오류는 시스템에 대해 예상하는 작동과 시스템이 실제 보이는 작동 간의 불일치다. 예를 들자면 위에 언급한 결함으로 인해 NullPointException이 발생하는 경우이다.
   - 실패 : 결함이 촉발되어 오류가 발생하면 실패로 이어져 시스템이 응답하지 않거나 요구사항에 따라 작동하지 못하게 될 수 있다.
     예를 들어 NullPointException이 발생하여 생긴 오류는 실패를 유발하고 시스템은 모든 요청에 500으로 응답하는 경우이다.
4. 관측 가능성 <br>
   시스템의 외부 출력에서 내부 상태를 얼마나 잘 추론할 수 있는지를 측정하는 것. 관측 가능성의 네 가지 요소가 있다.
   - 모니터링 : 애플리케이션의 전반적인 상태에 대한 정보를 얻고 실패를 식별하기 위해 애플리케이션의 특정 양상을 측정하는 것이다.
   - 경고/시각화 : 수집된 모니터링 데이터를 사용하여 사용자에게 경고를 보내거나 데이터를 시각화하는 것이다.
   - 인프라를 추적하는 분산 시스템 : 서브시스템 내의 작동을 추적할 뿐 아니라, 서로 다른 서브시스템 사이의 데이터를 추적하는 것도 필수이다.
   - 로그 집계/분석 : 애플리케이션의 주요 이벤트를 추적하는 것은 소프트웨어의 작동을 추론하고 문제 발생 시 디버깅을 하기 위해 중요한 작업이다.
5. 관리 용이성 <br>
   외부 입력이 시스템의 상태 또는 출력을 얼마나 쉽고 효율적으로 변경할 수 있는지에 대한 것. 즉, 코드를 바꾸지 않고도 애플리케이션의 작동을 수정할 수 있는 능력이다.
   **유지 보수성**과 혼동하면 안된다.

### 클라우드 네이티브를 지원하는 문화 및 관행
1. 자동화 <br>
    자동화는 클라우드 네이티브 애플리케이션의 핵심이다. 자동화는 빠르고 안정적인 서비스를 제공하고, 빠르게 시스템을 변경할 수 있도록 해준다.
2. 지속적 전달(CD) <br>
   지속적 전달이란 '프로덕션 환경에 언제든지 배포할 수 있는 방식으로 소프트웨어를 구축하는 소프트웨어 개발의 한 분야'이다.
   - 지속적 통합(CI) : 지속적 전달의 토대가 되는 관행이다. 개발자는 변경 사항을 기본 브랜치에 지속적으로, 적어도 하루에 한 번 커밋한다.
   - 지속적 전달(CD) : 지속적으로 변경 사항을 테스트하고, 테스트를 통과한 변경 사항을 프로덕션과 유사한 환경에 배포해서, 언제든지 프로덕션을 배포(새로운 버전으로 출시) 가능한 상태를 만든다. <br>
   지속적 전달과 지속적 배포는 다른 개념이며, 애플리케이션을 테스트하고 배포하기 위한 자동화된 파이프라인을 구축한다고 해서 그것이 반드시 지속적 전달을 의미하지 않는다.
3. 데브옵스
   데브옵스는 개발(Dev)과 운영(Ops)의 합성어로, `지위나 배경에 관계없이 사람들이 시스템을 구상, 개발, 배포 및 운영하기 위해 함께 협력하는 '문화'이다.` <br>
   **데브옵스는 자동화나 역할, 팀이 아니다**

## 클라우드가 최선의 선택인가?
클라우드를 사용한 마이크로서비스는 최선의 선택인가? 하면 아니라고 할 수 있다. 기업들이 모놀리스를 마이크로서비스로 이전하려다 실패한 사례는 끝도 없다. <br>
시스템이 문제점을 가지고 있고, 이를 해결할 수 있는 방법이 '클라우드 네이티브'가 아니라면 클라우드 네이티브는 최적의 방안이 아닐 수도 있다.

기술을 다루는 사람들은 최신 유행의 최첨단 기술에 쉽게 사로잡힌다. 특정 기술이나 접근 방식이 문제를 해결할 수 있는지 파악하는 것이 핵심이다. `아이디어를 소프트웨어로 바꾸고 이를 고객에게 전달하고 가치를 제공하는 것이 우리의 최종 목표`라는 것을 명심해야 한다.

**그렇다면 언제 클라우드로 옮겨가는 것이 좋을까?**
1. 속도
2. 복원력
3. 확장성
4. 비용

### 속도
자동화된 작업, 지속적 전달 워크플로우 및 데브옵스 관행과 연관된 클라우드 네이티브 접근 방식을 통해 기업은 일을 더 빨리 진행할 수 있고, 출시 시간을 단축할 수 있다.

### 복원력
모든 것은 변하고, 실패는 항상 일어난다. 변화는 예외가 아니라 상수다. <br>
복원력이 좋은 시스템은 잘못된 일이 발생하더라고 서비스를 계속 제공한다. 가용성을 보장하기 위해서는 실패가 발생할 때, 이를 직면해 처리하고 전체 시스템이 여전이 사용자들에게 서비스를 제공할 수 있게 해야한다. 이때 클라우드 네이티브가 좋은 선택이 될 수 있다.

### 비용
소프트웨어 개발자로서 비용적인 측면을 직접 다루지는 않더라도 솔루션 설계 시 비용을 고려해야 할 책인은 있다. 24시간 내내 실행되는 인프라는 더 이상 필요 없다. 필요한 자원만을 생성해 실제 사용한 만큼만 지불하고, 더 이상 필요없는 자원은 회수한다. 클라우드 네이티브 애플리케이션은 클라우드 탄력성을 활용하기 위해 확장 가능하도록 설계된다.

## 클라우드 네이티브 구성
클래우드 네이티브에서 컨테이너와 마이크로서비스를 반드시 사용할 필요는 없다. 그것들은 단지 기술일 뿐이다. AWS 람다 플랫폼을 위한 함수를 작성하는 경우를 생각해보라. 컨테이너를 만들 필요가 없다. 이런 방식 역시 클라우드 네이티브로 분류된다.

### 오케스트레이션
컨테이너를 사용하기로 결정했다면 훌륭한 결정이다! 단일 서버에서 컨테이너를 생성하고 관리하는 것은 간단하다. 하지만 **수십 또는 수백 개의 컨테이너를 여러 대의 서버에 배포하고 처리하려면** 또 다른 무언가가 필요하다.

컨테이너 오케스트레이션은 다음과 같은 다양한 작업을 자동화하는 데 도움이 된다.
- 클러스트 관리로서 필요한 경우 머신을 생성하거나 삭제할 수 있다.
- 컨테이너를 머신의 CPU 및 메모리에 따라 스케줄링 및 배포한다.
- 높은 가용성과 복원력을 위해 컨테이너를 동적으로 확장하고 상태 모니터링을 활용한다.
- 인터넷에 서비스를 노출하거나 포트 및 네트워크를 구성할 수 있다.
- 보안 및 액세스 제어 정책을 시행한다.

### 서버리스
- 서비스형 백엔드 <br>
  클라우드 공급자가 제공하는 타사 서비스에 크게 의존하는 애플리케이션을 의미한다. 타사 서비스로는 옥타, 파이어베이스 등의 인증 및 데이터베이스 서비스가 있다.
- 서비스형 함수 <br>
  상태가 없고 이벤트에 의해 실행되며 플랫폼이 전적으로 관리하는 애플리케이션을 의미한다. AWS 람다 함수, 애저 함수, 구글 클라우드 함수 등이 있다.

## 클라우드 네이티브 애플리케이션을 위한 서비스 기반 아키텍처
우리가 구축할 시스템의 아키텍처는 서비스와 상호작용이라는 두 가지 요소로 나뉜다.
- 서비스 : 다른 구성 요소에 어떤 종류의 서비스를 제공하는 구성 요소
- 상호작용 : 시스템의 요구 사항을 충족시키기 위해 수행되는 서비스 간 통신

서비스는 아주 일반적인 구성요소다. 무엇이든 서비스가 될 수 있다. 상태를 저장하는지에 따라 (상태를 갖지 않는) 애플리케이션 서비스와 (상태를 갖는) 데이터 서비스로 구별할 수 있다.

### 애플리케이션 서비스
상태를 갖지 않으며 모든 종류의 논리를 구현한다. 느슨한 결합과 높은 응집력을 염두에 두고 설계해야 한다.

### 데이터 서비스
데이터 서비스는 상태 저장이 가능하며 모든 종류의 상태를 저장한다. 상태는 '서비스를 종료하고 새로운 인스턴스를 생성해야 할 경우 서비스 종료 전에 저장되어야 하는 모든 것'이라고 정의할 수 있다. PostgreSQL 같은 관계형 데이터베이스를 예시로 생각할 수 있다.


